<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to implement a cache manager with the singleton pattern using Python
| Mustafa Abdallah
| 27 Feb 2023</title><meta name=keywords content><meta name=description content="How to implement a cache manager with the singleton pattern using Python - mstva"><link rel=canonical href=https://mstva.github.io/cache_manager_with_singleton_pattern/><link crossorigin=anonymous href=/assets/css/stylesheet.b1d6f76b6903dc2af3589bd5003920a591f4e4884ceb276ef158582e6c0d3e08.css integrity="sha256-sdb3a2kD3CrzWJvVADkgpZH05IhM6ydu8VhYLmwNPgg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://mstva.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://mstva.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://mstva.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://mstva.github.io/apple-touch-icon.png><link rel=mask-icon href=https://mstva.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://mstva.github.io/ accesskey=h title="mstva (Alt + H)">mstva</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://mstva.github.io/tech_writings/ title=tech_writings><span>tech_writings</span></a></li><li><a href=https://mstva.github.io/arabic_writings/ title=كتاباتي_بالعربية><span>كتاباتي_بالعربية</span></a></li><li><a href=https://mstva.github.io/projects/ title=projects><span>projects</span></a></li><li><a href=https://mstva.github.io/resume/Mustafa_Abdallah_Resume.pdf title=resume><span>resume</span></a></li><li><a href=https://mstva.github.io/hire/ title=hire_me><span>hire_me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>How to implement a cache manager with the singleton pattern using Python</h1><p class=post-date>Mustafa Abdallah - 27 Feb 2023</p><hr></header><div class=post-content><h3 id=introduction>Introduction</h3><p>In this article we will build a cache manager that stores frequently used data in memory using the Singleton pattern where the Singleton instance can ensure that the data is accessed efficiently and that memory usage is optimized.</p><h3 id=uml-diagram-of-the-cache-manager>UML Diagram of the Cache Manager</h3><p><img src=/images/cache_manager_uml.png alt="UML Diagram of the Cache Manager"></p><h3 id=code-implementation>Code Implementation</h3><p>The cache manager is very simple approach, we need to save data with predefined key and then use this key to retrieve this data and this approach could be achieved through the set and get methods as shown below, we will also use the singleton pattern that require a static method and private constructor, so we could get only one instance from the class every time we call it</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CacheManager</span>(object):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    _instance <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    _cache_store <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>RuntimeError</span>(<span style=color:#e6db74>&#34;Call get_instance() instead&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@classmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_instance</span>(cls):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> cls<span style=color:#f92672>.</span>_instance <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            cls<span style=color:#f92672>.</span>_instance <span style=color:#f92672>=</span> cls<span style=color:#f92672>.</span>__new__(cls)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> cls<span style=color:#f92672>.</span>_instance
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>set</span>(self, key, value):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_cache_store<span style=color:#f92672>.</span>append((key, value))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get</span>(self, key):
</span></span><span style=display:flex><span>        value <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>_cache_store:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> key <span style=color:#f92672>in</span> item:
</span></span><span style=display:flex><span>                value <span style=color:#f92672>=</span> item[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> value
</span></span></code></pre></div><p>This is just a simple example of cache manager, where it has two methods for setting and getting cache values.</p><h3 id=testing-the-cache-manager>Testing the Cache Manager</h3><p>We could test the cache manager as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>cache1 <span style=color:#f92672>=</span> CacheManager<span style=color:#f92672>.</span>get_instance()
</span></span><span style=display:flex><span>cache1<span style=color:#f92672>.</span>set(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;Mustafa&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cache2 <span style=color:#f92672>=</span> CacheManager<span style=color:#f92672>.</span>get_instance()
</span></span><span style=display:flex><span>cache2<span style=color:#f92672>.</span>set(<span style=color:#e6db74>&#34;role&#34;</span>, <span style=color:#e6db74>&#34;backend engineer&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(cache2<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;name&#34;</span>)) <span style=color:#75715e># note we use cache2 to get the name</span>
</span></span><span style=display:flex><span>print(cache2<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;role&#34;</span>))
</span></span></code></pre></div><p>And here is the result:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Mustafa
</span></span><span style=display:flex><span>backend engineer
</span></span></code></pre></div><p>As you can see, even creating multiple instances from the cache manager, but we still access only one instance.</p><h3 id=conclusion>Conclusion</h3><p>This cache manager could be useful in any Python application, where it caches data in memory and optimize the application performance.</p><h3 id=references>References</h3><ul><li><a href=https://www.amazon.com/Head-First-Design-Patterns-Brain-Friendly/dp/0596007124>Head First Design Patterns: A Brain-Friendly Guide</a></li><li><a href="https://www.youtube.com/watch?v=hUE_j6q0LTQ">Singleton Pattern – Design Patterns (ep 6) by Christopher Okhravi</a></li><li>I used <a href=https://www.draw.io/>draw.io</a> for drawing the UML diagram</li></ul></div></article></main><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild===n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>